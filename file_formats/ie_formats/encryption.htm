---
title: "Encryption"
---
    <div class="title_main">Encryption</div>
    <br />
    <div class="fileHeader">Text resource encryption</div>
    <div class="indent1">
      Several text files (mainly IDS files) are encrypted, to prevent casual tampering. The encryption is achieved by a simple 512bit XOR scheme. Each byte of the plaintext is XOR'd with a byte of the key. The key is rotated cyclically. The IE key is 64 bytes, so bytes 0-63 of the plaintext are XOR'd with bytes 0-63 of key, bytes 64-127 are XOR'd with bytes 0-63 of key, etc. Encrypted files have a 'header' of 0xFF 0xFF are the first two bytes.<br />
      <br />
      The encryption key is:<br />
      <pre>
          88 a8 8f ba 8a d3 b9 f5 ed b1 cf ea aa e4 b5 fb
          eb 82 f9 90 ca c9 b5 e7 dc 8e b7 ac ee f7 e0 ca
          8e ea ca 80 ce c5 ad b7 c4 d0 84 93 d5 f0 eb c8
          b4 9d cc af a5 95 ba 99 87 d2 9d e3 91 ba 90 ca
      </pre>
    </div>
    
    <div class="fileHeader">Executable string encryption</div>
    <div class="indent1">
      Several strings within the executable file are encrypted, to prevent casual detection. The encrypted strings are mainly cheat codes.<br />
      <br />
      The strings are encrypted via the following algorithm:
      <pre>
        char = (char + 8) &lt;&lt; 1
      </pre>
      The strings can be decrypted using the algorithm in reverse:
      <pre>
        char = (char &gt;&gt; 1) - 8
      </pre>
      <br />
      Strings within the IWD2 executable are encrypted with the algorithm: y=x*2+8.
    </div>
  </div>
</div>

